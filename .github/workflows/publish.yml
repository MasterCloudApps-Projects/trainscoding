name: Publish libraries workflow

on:
  push:
    branches: [ main ]
  workflow_dispatch:

env:
  NODE_AUTH_TOKEN: ${{ secrets.NPM_TOKEN }}

jobs:

  version-and-publish:
    name: Bump packages version and publish them
    runs-on: ubuntu-20.04

    steps:
    - name: Clone repository
      uses: actions/checkout@v2

    - name: Version and publish libraries
      run: make publish
      env:
        NODE_AUTH_TOKEN: $NODE_AUTH_TOKEN
